<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power BI Guide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.4;
            color: #333;
            padding: 20px;
            max-width: 800px;
            margin: auto;
            font-size: 14px;
        }
        h1, h2, h3, h4, h5 {
            color: #2c3e50;
            margin-top: 1em;
        }
        h1 {
            font-size: 1.8em;
        }
        h2 {
            font-size: 1.5em;
        }
        h3 {
            font-size: 1.2em;
        }
        h4, h5 {
            font-size: 1em;
        }
        p {
            margin: 0.5em 0;
        }
        ul, ol {
            margin: 0.5em 0 0.5em 1.5em;
        }
        .light-code {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 2px 4px;
            font-size: 0.9em;
            color: #c7254e;
        }
        .dark-code {
            background: #1e1e1e;
            color: #dcdcdc;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 10px;
            overflow: auto;
            line-height: 1.4;
        }
        .small-dark-code {
            background: #1e1e1e;
            color: #dcdcdc;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.9em;
            line-height: 1.2;
        }
        .code-container {
            margin: 1em 0;
        }
        a {
            color: #3498db;
        }
    </style>
</head>
<body>

    <h1>Power BI Guide</h1>

    <h2>Step 1: Adding Dataset</h2>
    <h3>1a. Python</h3>
    <p>Download Python: <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a> (skip if you have Python).</p>
    <p>Check Python installation:</p>
    <div class="code-container light-code">
        Open Command Prompt (cmd) &gt; Type: <code>where python</code>
    </div>

    <p>Install necessary packages:</p>
    <div class="code-container light-code">
        <code>C:\Program Files\Python312\python.exe -m pip install pandas openpyxl</code>
    </div>

    <p>Set Python home directory:</p>
    <div class="code-container light-code">
        <code>File &gt; Option and Settings &gt; Option &gt; Python Scripting &gt; Set Python home directory to the folder containing python.exe (e.g., "C:\Program Files\Python312")</code>
    </div>

    <p>Running Python in Power BI:</p>
    <ul>
        <li>Open Power BI &gt; Blank Report &gt; Home &gt; Transform Data &gt; Transform Data.</li>
        <li>Power Query Editor &gt; New Source &gt; More &gt; Type "Python" or scroll to find "Python Script" &gt; Select "Python Script".</li>
    </ul>

    <p>Copy and paste this in the Python script:</p>
    <div class="code-container dark-code">
<pre>
<code>
import pandas as pd

states = [
    ("Alabama", "AL", 32.806671, -86.791130),
    ("Alaska", "AK", 61.370716, -152.404419),
    ("Arizona", "AZ", 33.729759, -111.431221),
    ("Arkansas", "AR", 34.969704, -92.373123),
    ("California", "CA", 36.116203, -119.681564),
    ("Colorado", "CO", 39.059811, -105.311104),
    ("Connecticut", "CT", 41.597782, -72.755371),
    ("Delaware", "DE", 39.318523, -75.507141),
    ("Florida", "FL", 27.766279, -81.686783),
    ("Georgia", "GA", 33.040619, -83.643074),
    ("Hawaii", "HI", 21.094318, -157.498337),
    ("Idaho", "ID", 44.240459, -114.478828),
    ("Illinois", "IL", 40.349457, -88.986137),
    ("Indiana", "IN", 39.849426, -86.258278),
    ("Iowa", "IA", 42.011539, -93.210526),
    ("Kansas", "KS", 38.526600, -96.726486),
    ("Kentucky", "KY", 37.668140, -84.670067),
    ("Louisiana", "LA", 31.169546, -91.867805),
    ("Maine", "ME", 44.693947, -69.381927),
    ("Maryland", "MD", 39.063946, -76.802101),
    ("Massachusetts", "MA", 42.230171, -71.530106),
    ("Michigan", "MI", 43.326618, -84.536095),
    ("Minnesota", "MN", 45.694454, -93.900192),
    ("Mississippi", "MS", 32.741646, -89.678696),
    ("Missouri", "MO", 38.456085, -92.288368),
    ("Montana", "MT", 46.921925, -110.454353),
    ("Nebraska", "NE", 41.125370, -98.268082),
    ("Nevada", "NV", 38.313515, -117.055374),
    ("New Hampshire", "NH", 43.452492, -71.563896),
    ("New Jersey", "NJ", 40.298904, -74.521011),
    ("New Mexico", "NM", 34.840515, -106.248482),
    ("New York", "NY", 42.165726, -74.948051),
    ("North Carolina", "NC", 35.630066, -79.806419),
    ("North Dakota", "ND", 47.528912, -99.784012),
    ("Ohio", "OH", 40.388783, -82.764915),
    ("Oklahoma", "OK", 35.565342, -96.928917),
    ("Oregon", "OR", 44.572021, -122.070938),
    ("Pennsylvania", "PA", 40.590752, -77.209755),
    ("Rhode Island", "RI", 41.680893, -71.511780),
    ("South Carolina", "SC", 33.856892, -80.945007),
    ("South Dakota", "SD", 44.299782, -99.438828),
    ("Tennessee", "TN", 35.747845, -86.692345),
    ("Texas", "TX", 31.054487, -97.563461),
    ("Utah", "UT", 40.150032, -111.862434),
    ("Vermont", "VT", 44.045876, -72.710686),
    ("Virginia", "VA", 37.769337, -78.169968),
    ("Washington", "WA", 47.400902, -121.490494),
    ("West Virginia", "WV", 38.491226, -80.954456),
    ("Wisconsin", "WI", 44.268543, -89.616508),
    ("Wyoming", "WY", 42.755966, -107.302490)
]

feedback_sentiments = ["Positive", "Neutral", "Negative"]
feedback_cloud = ["great", "satisfactory", "poor", "excellent", "good", "average", "bad", "dry", "wet", "great staff"]

data = []
for i, (state, abbr, lat, long) in enumerate(states):
    sentiment = feedback_sentiments[i % len(feedback_sentiments)]
    feedback_word = feedback_cloud[i % len(feedback_cloud)]
    data.append({
        'Client ID': i + 1,
        'Client Name': f'{state} Corp',
        'Date': f'2024-{(i % 12) + 1:02d}-{(i % 28) + 1:02d}',
        'State': state,
        'Sales': (i + 1) * 1000,
        'Sentiment Score': round((i % 10) / 10, 2),
        'Feedback Sentiment': sentiment,
        'Feedback Cloud': feedback_word,
        'Latitude': lat,
        'Longitude': long
    })

df = pd.DataFrame(data)
file_path = r'C:\Users\Pawaneet Kaur\Desktop\Power BI Desktop\AllStatesSampleData1.xlsx'
df.to_excel(file_path, index=False)
print(f"Dataset created and saved as {file_path}")
</code>
</pre>
    </div>

    <p>After executing > select "df" under the Python folder > Close & Apply.</p>

    <h3>1b. Power Query M Script</h3>
    <h4>Open Power Query Editor</h4>
    <p>Click on Transform Data in the Home tab to open Power Query Editor.</p>

    <h4>Open Advanced Editor</h4>
    <p>In Power Query Editor, click on Home &gt; Advanced Editor.</p>

    <h4>Paste the M Script</h4>
    <p>Replace the existing code with the following script:</p>
    <div class="code-container dark-code">
<pre>
<code>
let
    Source = #table(
        type table [
            State = Text.Type, 
            Abbreviation = Text.Type, 
            Latitude =  number, 
            Longitude = number
        ],
        {
            {"Alabama", "AL", 32.806671, -86.791130},
            {"Alaska", "AK", 61.370716, -152.404419},
            {"Arizona", "AZ", 33.729759, -111.431221},
            {"Arkansas", "AR", 34.969704, -92.373123},
            {"California", "CA", 36.116203, -119.681564},
            {"Colorado", "CO", 39.059811, -105.311104},
            {"Connecticut", "CT", 41.597782, -72.755371},
            {"Delaware", "DE", 39.318523, -75.507141},
            {"Florida", "FL", 27.766279, -81.686783},
            {"Georgia", "GA", 33.040619, -83.643074},
            {"Hawaii", "HI", 21.094318, -157.498337},
            {"Idaho", "ID", 44.240459, -114.478828},
            {"Illinois", "IL", 40.349457, -88.986137},
            {"Indiana", "IN", 39.849426, -86.258278},
            {"Iowa", "IA", 42.011539, -93.210526},
            {"Kansas", "KS", 38.526600, -96.726486},
            {"Kentucky", "KY", 37.668140, -84.670067},
            {"Louisiana", "LA", 31.169546, -91.867805},
            {"Maine", "ME", 44.693947, -69.381927},
            {"Maryland", "MD", 39.063946, -76.802101},
            {"Massachusetts", "MA", 42.230171, -71.530106},
            {"Michigan", "MI", 43.326618, -84.536095},
            {"Minnesota", "MN", 45.694454, -93.900192},
            {"Mississippi", "MS", 32.741646, -89.678696},
            {"Missouri", "MO", 38.456085, -92.288368},
            {"Montana", "MT", 46.921925, -110.454353},
            {"Nebraska", "NE", 41.125370, -98.268082},
            {"Nevada", "NV", 38.313515, -117.055374},
            {"New Hampshire", "NH", 43.452492, -71.563896},
            {"New Jersey", "NJ", 40.298904, -74.521011},
            {"New Mexico", "NM", 34.840515, -106.248482},
            {"New York", "NY", 42.165726, -74.948051},
            {"North Carolina", "NC", 35.630066, -79.806419},
            {"North Dakota", "ND", 47.528912, -99.784012},
            {"Ohio", "OH", 40.388783, -82.764915},
            {"Oklahoma", "OK", 35.565342, -96.928917},
            {"Oregon", "OR", 44.572021, -122.070938},
            {"Pennsylvania", "PA", 40.590752, -77.209755},
            {"Rhode Island", "RI", 41.680893, -71.511780},
            {"South Carolina", "SC", 33.856892, -80.945007},
            {"South Dakota", "SD", 44.299782, -99.438828},
            {"Tennessee", "TN", 35.747845, -86.692345},
            {"Texas", "TX", 31.054487, -97.563461},
            {"Utah", "UT", 40.150032, -111.862434},
            {"Vermont", "VT", 44.045876, -72.710686},
            {"Virginia", "VA", 37.769337, -78.169968},
            {"Washington", "WA", 47.400902, -121.490494},
            {"West Virginia", "WV", 38.491226, -80.954456},
            {"Wisconsin", "WI", 44.268543, -89.616508},
            {"Wyoming", "WY", 42.755966, -107.302490}
        }
    ),

    AddClientID = Table.AddIndexColumn(Source, "Client ID", 1, 1, Int64.Type),
    AddClientName = Table.AddColumn(AddClientID, "Client Name", each [State] & " Corp"),
    AddDate = Table.AddColumn(AddClientName, "Date", each Date.FromText("2024-" & Text.PadStart(Text.From(Number.Mod([Client ID], 12) + 1), 2, "0") & "-" & Text.PadStart(Text.From(Number.Mod([Client ID], 28) + 1), 2, "0")), type date),
    AddSales = Table.AddColumn(AddDate, "Sales", each [Client ID] * 1000),
    AddSentimentScore = Table.AddColumn(AddSales, "Sentiment Score", each Number.RoundUp(Number.Mod([Client ID], 10) / 10, 2)),
    AddFeedbackSentiment = Table.AddColumn(AddSentimentScore, "Feedback Sentiment", each 
        let
            Sentiments = {"Positive", "Neutral", "Negative"}
        in
            Sentiments{Number.Mod([Client ID] - 1, 3)}
    ),
    AddFeedbackCloud = Table.AddColumn(AddFeedbackSentiment, "Feedback Cloud", each 
        let
            Feedbacks = {"great", "satisfactory", "poor", "excellent", "good", "average", "bad", "dry", "wet", "great staff"}
        in
            Feedbacks{Number.Mod([Client ID] - 1, 10)}
    )
in
    AddFeedbackCloud
</code>
</pre>
    </div>

    <h4>Apply the Script</h4>
    <p>Click Done to close the Advanced Editor and apply the transformations.</p>

    <h4>Close & Apply</h4>
    <p>Once all columns are added and the script is applied, click on Close & Apply to load the transformed data into Power BI.</p>

    <h2>Step 2: Overview Page</h2>

    <h3>Filter</h3>
    <p><strong>Visualization &gt; Slicer</strong></p>
    <p>Under "Field" - drag "Client Name," "State," and "Date" separately.</p>
    <p>Under visuals > Slicer setting > drop down (to allow a drop down option).</p>

    <h3>Sales Page Button Tab</h3>
    <ul>
        <li>Optional: Insert &gt; Button &gt; Navigator &gt; Page Navigator.</li>
        <li>View &gt; Bookmarks &gt; Add "Sales" &gt; Insert &gt; Button &gt; Navigator &gt; Bookmark Navigator.</li>
        <li>Open page/button: Ctrl + Click.</li>
    </ul>

    <h3>Gift Tractor</h3>
    <ul>
        <li>Insert &gt; Buttons &gt; Blank &gt; Fill &gt; Browse &gt; Set transparency to 0%.</li>
        <li>Set Border off (optional).</li>
        <li>Search on Google for a tractor animation GIF (right click on the image &gt; Save as image &gt; Save as GIF).</li>
    </ul>

    <h3>Card</h3>
    <ul>
        <li>Visualization &gt; Under Fields &gt; Drag "Sum of Sales".</li>
        <li>Visualization &gt; Under Fields &gt; Drag "Count of Client" (ensure to rename appropriately).</li>
    </ul>

    <h3>DAX Calculation</h3>
    <p>Measure Tool &gt; New Measure &gt; Enter:</p>
    <div class="code-container dark-code">
<pre>
<code>
Average Sales per Sentiment = 
CALCULATE(
    AVERAGE('df'[Sales]),
    ALLEXCEPT('df', 'df'[Feedback Sentiment]))
</code>
</pre>
    </div>

    <ul>
        <li>Visualization &gt; Under Fields &gt; Drag "Average Sales per Sentiment".</li>
    </ul>

    <h3>Playing Around with DAX</h3>
    <p><strong>Create YearMonth Column:</strong></p>
    <p>Go to Modeling &gt; New Column:</p>
    <div class="code-container small-dark-code">
<pre>
<code>
YearMonth = FORMAT(Table1[Date], "YYYY-MM")
</code>
</pre>
    </div>

    <h3>Line and Clustered Column Chart</h3>
    <p>Build Visuals:</p>
    <ul>
        <li>X-axis: Date (select Month, Day).</li>
        <li>Column Y-axis: Sum of Sales.</li>
        <li>Line Y-axis: Sum of Sentiment Score.</li>
    </ul>

    <p>Format Visuals:</p>
    <ul>
        <li>Under Visuals, look into legends (optional).</li>
        <li>Under General, Title - change the title and set horizontal alignment to "center".</li>
    </ul>

    <h3>Waterfall Chart</h3>
    <p>Category: Sentiment Score.</p>
    <p>Y-axis: Sum of Sales.</p>

    <h3>Feedback Cloud</h3>
    <p>Insert &gt; More Visuals &gt; From AppSource &gt; Search "Cloud" to find Word Cloud.</p>
    <p>Click on Word Cloud icon under build visuals &gt; Category: Drag "Feedback Cloud".</p>

    <h2>Step 3: Map Settings</h2>
    <ul>
        <li>Path: File &gt; Options and Settings &gt; Options.</li>
        <li>Security: Enable "Use Map and Filled Map visuals".</li>
        <li>Preview Features: Check "Shape map visual".</li>
    </ul>

    <h3>Choropleth Map</h3>
    <ul>
        <li>Filled Maps icon &gt; Under:
            <ul>
                <li>Location: Drag "States".</li>
                <li>Legend: Drag "Sales".</li>
            </ul>
        </li>
    </ul>
    <p>Format Visuals:</p>
    <ul>
        <li>Under Visuals, select legend to adjust position.</li>
    </ul>

    <h3>Proportional Symbol Map</h3>
    <ul>
        <li>Maps icon &gt; Under:
            <ul>
                <li>Latitude: Drag "Latitude".</li>
                <li>Longitude: Drag "Longitude".</li>
                <li>Bubble Size: Drag "Sales" (sum of sales).</li>
            </ul>
        </li>
    </ul>

    <h3>Donut Chart</h3>
    <ul>
        <li>Donut Chart icon &gt; Under:
            <ul>
                <li>Legend: Drag "Feedback Sentiment".</li>
                <li>Values: Drag "Client ID" (Count of Client ID).</li>
            </ul>
        </li>
    </ul>

    <p>Under Format Visualization (Visual Tab):</p>
    <ul>
        <li>Legend, title position.</li>
        <li>Spacing, setting inner radius.</li>
    </ul>

    <h3>Adding the Smiley Face Image</h3>
    <ul>
        <li>Open PowerPoint &gt; Insert &gt; Icon &gt; Type "face" &gt; Select the face.</li>
        <li>Change the color of the face &gt; Click on the smiley face image &gt; Graphics fill &gt; Right-click the image &gt; Save as picture &gt; Save as "Graphics Interchange Format".</li>
    </ul>

    <h2>Step 4: Sales Page</h2>
    <ul>
        <li>Under Visualization &gt; Canvas Background &gt; Change the colors (optional).</li>
    </ul>

    <h3>Add Moving Background</h3>
    <ul>
        <li>Go to Pixabay, select an image (e.g., <a href="https://pixabay.com/videos/vegetables-leaves-plantation-crop-175717/">https://pixabay.com/videos/vegetables-leaves-plantation-crop-175717/</a>).</li>
        <li>Download + select 1920x1080.</li>
        <li>Convert video to GIF using <a href="https://ezgif.com/video-to-gif">https://ezgif.com/video-to-gif</a>.</li>
        <li>Change:
            <ul>
                <li>End time (seconds): 9.</li>
                <li>Frame rate (FPS): 33 (max 10 seconds).</li>
            </ul>
        </li>
        <li>Select "Convert to GIF!".</li>
        <li>Under Visualization (select on something blank) > Format Page > Canvas Background > Under "Image" select your wallpaper gif > Then under "Image fit "> Fit.</li>
        <li>Adjust transparency to 0%.</li>
    </ul>

    <h3>Adding Shapes Behind Graphs</h3>
    <ul>
        <li>Insert &gt; Shapes &gt; Rectangle &gt; Under Shape, select "Rounded Rectangle".</li>
        <li>Fill &gt; Color - change the color.</li>
        <li>Repeat this four times for adding four visuals/graphs.</li>
    </ul>

    <h3>Key Influencers</h3>
    <ul>
        <li>Key Influencers icon &gt; Under:
            <ul>
                <li>Analyze: Drag "Sales".</li>
                <li>Explain by: Drag "Sales" (Sum of Sales).</li>
            </ul>
        </li>
    </ul>

    <h3>Decomposition Tree</h3>
    <ul>
        <li>Decomposition Tree icon &gt; Under:
            <ul>
                <li>Analyze: Drag "Sales" (Sum of Sales).</li>
                <li>Explain by: Drag "Client Name".</li>
            </ul>
        </li>
        <li>In the decomposition tree, select Client Name &gt; High Value.</li>
    </ul>

    <h3>Stacked Area Chart</h3>
    <ul>
        <li>Stacked Area Chart icon &gt; Under:
            <ul>
                <li>X-axis: Drag "Feedback Sentiment".</li>
                <li>Y-axis: Drag "Sales" (Sum of Sales).</li>
            </ul>
        </li>
    </ul>

    <h3>Narrative</h3>
    <ul>
        <li>Narrative icon &gt; Select "Custom" if you do not have/want to use "Copilot".</li>
    </ul>

</body>
</html>

