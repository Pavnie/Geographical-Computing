<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power BI Guide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.4;
            color: #333;
            padding: 20px;
            max-width: 800px;
            margin: auto;
            font-size: 14px;
        }
        h1, h2, h3, h4, h5 { color: #2c3e50; margin-top: 1em; }
        h1 { font-size: 1.8em; }
        h2 { font-size: 1.5em; }
        h3 { font-size: 1.2em; }
        h4, h5 { font-size: 1em; }
        p, ul, ol { margin: 0.5em 0; }
        ul, ol { margin-left: 1.5em; }
        .light-code, .dark-code, .small-dark-code {
            border-radius: 4px; padding: 4px 8px; overflow: auto; line-height: 1.2;
        }
        .light-code { background: #f4f4f4; border: 1px solid #ddd; color: #c7254e; }
        .dark-code, .small-dark-code { background: #1e1e1e; color: #dcdcdc; border: 1px solid #333; }
        .dark-code { padding: 10px; }
        a { color: #3498db; }
    </style>
</head>
<body>
    <h1>Power BI Guide</h1>
    <h2>Step 1: Adding Dataset</h2>
    <h3>1a. Python</h3>
    <p>Download Python: <a href="https://www.python.org/downloads/">here</a> (skip if you have Python).</p>
    <p>Check Python installation:</p>
    <div class="light-code">Open Command Prompt (cmd) &gt; Type: <code>where python</code></div>
    <p>Install necessary packages:</p>
    <div class="light-code"><code>python -m pip install pandas openpyxl</code></div>
    <p>Set Python home directory:</p>
    <div class="light-code"><code>File &gt; Options &gt; Python Scripting &gt; Set Python home directory</code></div>
    <p>Running Python in Power BI:</p>
    <ul>
        <li>Open Power BI &gt; Home &gt; Transform Data &gt; New Source &gt; Python Script</li>
    </ul>
    <p>Copy and paste this in the Python script:</p>
    <div class="dark-code"><pre><code>import pandas as pd
# ... (Python code here) ...
df.to_excel(r'C:\Users\YourPath\AllStatesSampleData1.xlsx', index=False)
print("Dataset created")</code></pre></div>
    <h3>1b. Power Query M Script</h3>
    <h4>Open Power Query Editor</h4>
    <p>Click on Transform Data &gt; Advanced Editor.</p>
    <h4>Paste the M Script</h4>
    <div class="dark-code"><pre><code>let
    Source = #table(type table [...]),
    AddClientID = Table.AddIndexColumn(Source, "Client ID", 1, 1, Int64.Type),
    AddClientName = Table.AddColumn(AddClientID, "Client Name", each [State] & " Corp"),
    AddDate = Table.AddColumn(AddClientName, "Date", each ...),
    AddSales = Table.AddColumn(AddDate, "Sales", each ...),
    AddSentimentScore = Table.AddColumn(AddSales, "Sentiment Score", each ...),
    AddFeedbackSentiment = Table.AddColumn(AddSentimentScore, "Feedback Sentiment", each ...),
    AddFeedbackCloud = Table.AddColumn(AddFeedbackSentiment, "Feedback Cloud", each ...)
in
    AddFeedbackCloud</code></pre></div>
    <h2>Step 2: Overview Page</h2>
    <h3>Filter</h3>
    <p><strong>Visualization &gt; Slicer</strong> - Drag "Client Name," "State," and "Date".</p>
    <h3>Sales Page Button Tab</h3>
    <ul>
        <li>Optional: Insert &gt; Button &gt; Navigator &gt; Page Navigator.</li>
    </ul>
    <h3>Card</h3>
    <ul>
        <li>Visualization &gt; Fields &gt; Drag "Sum of Sales" and "Count of Client".</li>
    </ul>
    <h3>DAX Calculation</h3>
    <p>Measure Tool &gt; New Measure:</p>
    <div class="dark-code"><pre><code>Average Sales per Sentiment = 
CALCULATE(AVERAGE('df'[Sales]), ALLEXCEPT('df', 'df'[Feedback Sentiment]))</code></pre></div>
    <h2>Step 3: Map Settings</h2>
    <ul>
        <li>File &gt; Options and Settings &gt; Options &gt; Security: Enable "Use Map and Filled Map visuals".</li>
    </ul>
    <h3>Choropleth Map</h3>
    <ul>
        <li>Filled Maps icon &gt; Location: Drag "States", Legend: Drag "Sales".</li>
    </ul>
    <h3>Proportional Symbol Map</h3>
    <ul>
        <li>Maps icon &gt; Latitude: Drag "Latitude", Longitude: Drag "Longitude", Bubble Size: Drag "Sales".</li>
    </ul>
    <h3>Donut Chart</h3>
    <ul>
        <li>Donut Chart icon &gt; Legend: Drag "Feedback Sentiment", Values: Drag "Client ID".</li>
    </ul>
    <h2>Step 4: Sales Page</h2>
    <ul>
        <li>Under Visualization &gt; Canvas Background &gt; Change colors (optional).</li>
    </ul>
</body>
</html>
